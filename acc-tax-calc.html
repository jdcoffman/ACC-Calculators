<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Property Tax Impact</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="wrap">
    <div class="topnav">
      <a class="back" href="index.html">← Back</a>
    </div>

    <div class="card">
      <h2>Property Tax Impact</h2>
      <p class="sub">Estimate annual ACC tax, including exemptions. All amounts are rounded to the nearest $1.</p>

      <div class="row">
        <div class="col">
          <label>Home value</label>
          <div class="chips" id="valueChips"></div>

          <div id="customWrap" style="display:none; margin-top:10px;">
            <label style="margin-top:0;">Custom home value ($)</label>
            <input id="customValue" type="number" min="0" step="1000" inputmode="numeric" placeholder="Enter your home value" />
          </div>

          <div class="toggle">
            <div class="meta">
              <span>Homestead exemption</span>
              <span>For ACC: max($5,000, 1% of home value)</span>
            </div>
            <label class="switch">
              <input id="hasHomestead" type="checkbox" checked />
              <span class="slider"></span>
            </label>
          </div>

          <div class="toggle">
            <div class="meta">
              <span>Age 65+ exemption</span>
              <span>Additional $75,000 (applied once). Rate frozen after year-1.</span>
            </div>
            <label class="switch">
              <input id="has65" type="checkbox" />
              <span class="slider"></span>
            </label>
          </div>

          <div class="toggle">
            <div class="meta">
              <span>Disabled exemption</span>
              <span>Additional $75,000 (applied once). Rate frozen after year-1.</span>
            </div>
            <label class="switch">
              <input id="hasDisabled" type="checkbox" />
              <span class="slider"></span>
            </label>
          </div>
        </div>

        <div class="col">
          <label>Show as</label>
          <div class="segment" role="tablist" aria-label="Billing period">
            <button type="button" id="perDayBtn" aria-selected="false">Day</button>
            <button type="button" id="perMonthBtn" class="active" aria-selected="true">Month</button>
            <button type="button" id="perYearBtn" aria-selected="false">Year</button>
          </div>

          <div class="result" aria-live="polite">
            <div class="resultGrid">
              <div class="metric">
                <p class="k">Taxable value (after exemptions)</p>
                <p class="v" id="taxableOut">$0</p>
              </div>
              <div class="metric good">
                <p class="k" id="taxLabel">Estimated ACC tax (per month)</p>
                <p class="v" id="taxOut">$0</p>
              </div>
            </div>

            <div class="whatIncludes" id="breakdownOut"></div>
          </div>

          <div class="accordion" aria-label="FAQs">
            <details class="faq">
              <summary><span>What is the ACC tax rate?</span><span class="caret" aria-hidden="true"></span></summary>
              <div class="faqBody">ACC’s adopted rate is $0.1034 per $100 of taxable value (about $103.40 per $100,000 of taxable value). Rates can change each year.</div>
            </details>

            <details class="faq">
              <summary><span>What does “taxable value” mean?</span><span class="caret" aria-hidden="true"></span></summary>
              <div class="faqBody">Taxable value is your home’s value after exemptions are applied. Your county appraisal district calculates it.</div>
            </details>

            <details class="faq">
              <summary><span>What is the Homestead exemption in this calculator?</span><span class="caret" aria-hidden="true"></span></summary>
              <div class="faqBody">For ACC, the homestead exemption is the larger of $5,000 or 1% of your home’s value. This reduces the taxable value used to calculate the ACC tax.</div>
            </details>

            <details class="faq">
              <summary><span>What is the Age 65+ / Disabled exemption?</span><span class="caret" aria-hidden="true"></span></summary>
              <div class="faqBody">ACC provides an additional $75,000 exemption for homeowners who qualify as age 65+ or disabled (in addition to the homestead exemption, if you have it).</div>
            </details>

            <details class="faq">
              <summary><span>If I’m 65+ or disabled, what does “tax ceiling” (freeze) mean?</span><span class="caret" aria-hidden="true"></span></summary>
              <div class="faqBody">A tax ceiling means the ACC portion of your tax bill can’t increase above the amount you pay in the year the ceiling starts for ACC. It can go down, but it generally can’t go up (certain home improvements can change the ceiling rules).</div>
            </details>

            <details class="faq">
              <summary><span>I already have the 65+ exemption. Will my ACC tax be frozen at my old (pre-ACC) amount?</span><span class="caret" aria-hidden="true"></span></summary>
              <div class="faqBody">No. If ACC wasn’t taxing your property before, there was no ACC tax amount to freeze. The ACC ceiling would start the first year your property is taxed by ACC as an in-district property.</div>
            </details>

            <details class="faq">
              <summary><span>Do I need to reapply for exemptions if we become in-district?</span><span class="caret" aria-hidden="true"></span></summary>
              <div class="faqBody">Usually no if your exemptions are already on file, but you should verify with your county appraisal district. This tool assumes exemptions are already applied correctly.</div>
            </details>

            <details class="faq">
              <summary><span>Does this affect renters?</span><span class="caret" aria-hidden="true"></span></summary>
              <div class="faqBody">Renters don’t receive exemptions directly, but property taxes can affect housing costs over time. The main direct benefit for renters is education and job training access (tuition, programs, retraining).</div>
            </details>

            <details class="faq">
              <summary><span>What does “in-district” change besides taxes?</span><span class="caret" aria-hidden="true"></span></summary>
              <div class="faqBody">In-district status reduces ACC tuition for residents and can remove out-of-district charges for students who take ACC classes. It also makes it easier to expand dual-credit, career training, and adult education participation because the cost barrier is lower.</div>
            </details>

            <details class="faq">
              <summary><span>Why does the calculator show “Age 65+” and “Disabled” separately?</span><span class="caret" aria-hidden="true"></span></summary>
              <div class="faqBody">They are separate qualification paths. The additional ACC exemption amount is applied once, even if someone qualifies under both.</div>
            </details>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const ACC_RATE_PER_100 = 0.1034;
    const HOMESTEAD_MIN = 5000;
    const HOMESTEAD_PCT = 0.01;
    const ADDL_EXEMPT_65_DISABLED = 75000;

    const VALUE_PRESETS = [250000, 350000, 450000, 550000, 650000, 800000];

    const $ = (id) => document.getElementById(id);

    function formatMoney0(n){
      const v = Number(n);
      if (!isFinite(v)) return "$0";
      return v.toLocaleString(undefined, { style:"currency", currency:"USD", maximumFractionDigits:0 });
    }
    function round1(n){ return Math.round(Number(n) || 0); }

    let period = "month"; // default
    let valueMode = "preset"; // "preset" | "custom"
    let presetValue = 350000;

    function setPeriod(next){
      period = next;
      $("perDayBtn").classList.toggle("active", period === "day");
      $("perMonthBtn").classList.toggle("active", period === "month");
      $("perYearBtn").classList.toggle("active", period === "year");

      $("perDayBtn").setAttribute("aria-selected", period === "day");
      $("perMonthBtn").setAttribute("aria-selected", period === "month");
      $("perYearBtn").setAttribute("aria-selected", period === "year");

      const label = period === "day" ? "per day" : (period === "month" ? "per month" : "per year");
      $("taxLabel").textContent = `Estimated ACC tax (${label})`;
      compute();
    }

    function selectChip(key){
      [...$("valueChips").querySelectorAll("button.chip")].forEach(btn => {
        btn.classList.toggle("selected", btn.dataset.key === String(key));
      });
    }

    function setPreset(v){
      valueMode = "preset";
      presetValue = Number(v);
      $("customWrap").style.display = "none";
      selectChip(String(v));
      compute();
    }

    function setCustom(){
      valueMode = "custom";
      $("customWrap").style.display = "block";
      selectChip("custom");
      if (!$("customValue").value) $("customValue").value = String(presetValue);
      $("customValue").focus();
      compute();
    }

    function getHomeValue(){
      if (valueMode === "custom") {
        return Math.max(0, Number($("customValue").value || 0));
      }
      return Math.max(0, Number(presetValue || 0));
    }

    function buildChips(){
      const host = $("valueChips");
      host.innerHTML = "";

      VALUE_PRESETS.forEach(v => {
        const b = document.createElement("button");
        b.type = "button";
        b.className = "chip";
        b.dataset.key = String(v);
        b.textContent = formatMoney0(v);
        b.addEventListener("click", () => setPreset(v));
        host.appendChild(b);
      });

      const c = document.createElement("button");
      c.type = "button";
      c.className = "chip";
      c.dataset.key = "custom";
      c.textContent = "Custom";
      c.addEventListener("click", () => setCustom());
      host.appendChild(c);

      selectChip(String(presetValue));
    }

    function compute(){
      const homeValue = getHomeValue();

      const hasHomestead = $("hasHomestead").checked;
      const has65 = $("has65").checked;
      const hasDisabled = $("hasDisabled").checked;

      const homesteadEx = hasHomestead ? Math.max(HOMESTEAD_MIN, homeValue * HOMESTEAD_PCT) : 0;
      const addlEx = (has65 || hasDisabled) ? ADDL_EXEMPT_65_DISABLED : 0;

      const taxable = Math.max(0, homeValue - homesteadEx - addlEx);
      const annualTax = (taxable / 100) * ACC_RATE_PER_100;

      let displayTax = annualTax;
      if (period === "month") displayTax = annualTax / 12;
      if (period === "day") displayTax = annualTax / 365;

      $("taxableOut").textContent = formatMoney0(round1(taxable));
      $("taxOut").textContent = formatMoney0(round1(displayTax));

      const parts = [];
      parts.push(`Home value: ${formatMoney0(round1(homeValue))}`);
      if (hasHomestead) parts.push(`Homestead exemption: −${formatMoney0(round1(homesteadEx))}`);
      if (addlEx > 0) parts.push(`65+/Disabled exemption: −${formatMoney0(round1(addlEx))}`);
      parts.push(`Taxable value: ${formatMoney0(round1(taxable))}`);
      parts.push(`Annual ACC tax: ${formatMoney0(round1(annualTax))}`);
      $("breakdownOut").textContent = parts.join(" • ");
    }

    ["hasHomestead","has65","hasDisabled"].forEach(id => {
      $(id).addEventListener("change", compute);
    });

    $("customValue").addEventListener("input", compute);

    $("perDayBtn").addEventListener("click", () => setPeriod("day"));
    $("perMonthBtn").addEventListener("click", () => setPeriod("month"));
    $("perYearBtn").addEventListener("click", () => setPeriod("year"));

    buildChips();
    setPeriod("month");
    compute();
  </script>
</body>
</html>